{"ast":null,"code":"var _jsxFileName = \"/Users/ijuhyeon/Documents/community/2-hyun-lee-community-re/my-react-app/src/pages/detailPost.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { fetchUserData } from \"../utils/fetchUserData.js\";\nimport { fetchPostDetails, fetchComments, deletePost, updatePostLikes, updatePostViews, userLikeStatus } from \"../api/postApi.js\";\nimport Header from \"../components/Header\";\nimport PostHeader from \"../components/PostHeader\";\nimport CommentsSection from \"../components/CommentsSection\";\nimport ConfirmationModal from \"../components/ConfirmationModal\";\nimport { getImageUrl } from \"../api/userApi\";\nimport \"../styles/global-style.css\";\nimport \"../styles/detailPost-style.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DetailPost = () => {\n  _s();\n  const location = useLocation();\n  const params = new URLSearchParams(location.search);\n  const post_id = params.get(\"post_id\");\n  const navigate = useNavigate();\n  const [post, setPost] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [commentCount, setCommentCount] = useState(0);\n  const [likeCount, setLikeCount] = useState(0);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [userId, setUserId] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [modalContent, setModalContent] = useState({});\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const currentUser = await fetchUserData();\n        if (currentUser) setCurrentUser(currentUser);\n        const postDetails = await fetchPostDetails(post_id);\n        console.log(postDetails.posts[0]);\n        setPost(postDetails.posts[0]);\n        setLikeCount(postDetails.posts[0].likes_count);\n        setUserId(postDetails.user_id);\n        setCommentCount(postDetails.posts[0].comment_count);\n        const commentResults = await fetchComments(post_id);\n        setComments(commentResults.comments);\n        await updatePostViews(post_id);\n      } catch (error) {\n        console.error(\"Error:\", error);\n      }\n    };\n    fetchData();\n  }, [post_id]);\n  const handleLike = async () => {\n    try {\n      const result = await userLikeStatus(post_id);\n      const liked = result.result.is_exist;\n      if (liked) {\n        setLikeCount(prev => prev - 1);\n      } else {\n        setLikeCount(prev => prev + 1);\n      }\n      await updatePostLikes(post_id, userId);\n    } catch (error) {\n      console.error(\"Error:\", error);\n    }\n  };\n  const handleEditPost = async () => {\n    navigate(`/edit-post?post_id=${post_id}`);\n  };\n  const handleDeletePost = async () => {\n    setModalContent({\n      title: \"게시글 삭제\",\n      message: \"게시글을 삭제하시겠습니까? 복구할 수 없습니다.\",\n      onConfirm: async () => {\n        try {\n          await deletePost(post_id);\n          navigate(\"/board\");\n        } catch (error) {\n          console.error(\"Error:\", error);\n        }\n      }\n    });\n    setIsModalOpen(true);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      title: \"\\uC544\\uBB34\\uB9D0 \\uB300\\uC794\\uCE58\",\n      profileImage: currentUser ? getImageUrl(currentUser.userInfo.profile_image) : null,\n      onBack: () => navigate(\"/board\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post-container\",\n      children: [post && /*#__PURE__*/_jsxDEV(PostHeader, {\n        post: post,\n        likeCount: likeCount,\n        handleLike: handleLike,\n        userId: userId,\n        handleDeletePost: handleDeletePost,\n        handleEditPost: handleEditPost,\n        commentCount: commentCount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(CommentsSection, {\n        comments: comments,\n        postId: post_id,\n        setComments: setComments,\n        setCommentCount: setCommentCount,\n        user: currentUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 10\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this), isModalOpen && /*#__PURE__*/_jsxDEV(ConfirmationModal, {\n      show: isModalOpen,\n      title: modalContent.title,\n      message: modalContent.message,\n      onConfirm: modalContent.onConfirm,\n      onCancel: () => setIsModalOpen(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(DetailPost, \"HI2Gr1p6QHbCZMYF60r5pRdA7tA=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = DetailPost;\nexport default DetailPost;\nvar _c;\n$RefreshReg$(_c, \"DetailPost\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useLocation","fetchUserData","fetchPostDetails","fetchComments","deletePost","updatePostLikes","updatePostViews","userLikeStatus","Header","PostHeader","CommentsSection","ConfirmationModal","getImageUrl","jsxDEV","_jsxDEV","Fragment","_Fragment","DetailPost","_s","location","params","URLSearchParams","search","post_id","get","navigate","post","setPost","comments","setComments","commentCount","setCommentCount","likeCount","setLikeCount","currentUser","setCurrentUser","userId","setUserId","isModalOpen","setIsModalOpen","modalContent","setModalContent","fetchData","postDetails","console","log","posts","likes_count","user_id","comment_count","commentResults","error","handleLike","result","liked","is_exist","prev","handleEditPost","handleDeletePost","title","message","onConfirm","children","profileImage","userInfo","profile_image","onBack","fileName","_jsxFileName","lineNumber","columnNumber","className","postId","user","show","onCancel","_c","$RefreshReg$"],"sources":["/Users/ijuhyeon/Documents/community/2-hyun-lee-community-re/my-react-app/src/pages/detailPost.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { fetchUserData } from \"../utils/fetchUserData.js\"; \n\nimport {\n    fetchPostDetails,\n    fetchComments,\n    deletePost,\n    updatePostLikes,\n    updatePostViews,\n    userLikeStatus,\n  } from \"../api/postApi.js\";\nimport Header from \"../components/Header\";\nimport PostHeader from \"../components/PostHeader\";\nimport CommentsSection from \"../components/CommentsSection\"\nimport ConfirmationModal from \"../components/ConfirmationModal\";\nimport { getImageUrl } from \"../api/userApi\";\nimport \"../styles/global-style.css\";\nimport \"../styles/detailPost-style.css\";\n\n\nconst DetailPost = () =>{\n    const location = useLocation();\n    const params = new URLSearchParams(location.search);\n    const post_id = params.get(\"post_id\");\n    const navigate = useNavigate();\n    const [post, setPost] = useState(null);\n    const [comments, setComments] = useState([]);\n    const [commentCount, setCommentCount] = useState(0);\n    const [likeCount, setLikeCount] = useState(0);\n    const [currentUser, setCurrentUser] = useState(null);\n    const [userId, setUserId] = useState(null);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [modalContent, setModalContent] = useState({});\n\n    useEffect( ()=>{\n        const fetchData = async () =>{\n            \n        \n             try {\n                const currentUser = await fetchUserData();\n                if(currentUser) setCurrentUser(currentUser);\n                const postDetails = await fetchPostDetails(post_id);\n                \n                console.log(postDetails.posts[0]);\n                setPost(postDetails.posts[0]);\n                setLikeCount(postDetails.posts[0].likes_count);\n                setUserId(postDetails.user_id);\n                setCommentCount(postDetails.posts[0].comment_count)\n                const commentResults = await fetchComments(post_id);\n                setComments(commentResults.comments);\n\n                await updatePostViews(post_id);\n            } catch (error) {\n                console.error(\"Error:\", error);\n            }\n        }\n        fetchData();\n    },[post_id]);\n    \n    const handleLike = async () =>{\n        try {\n            const result = await userLikeStatus(post_id);\n    \n            const liked = result.result.is_exist;\n      \n            if (liked) {\n              setLikeCount((prev) => prev - 1);\n            } else {\n              setLikeCount((prev) => prev + 1);\n            }\n      \n            await updatePostLikes(post_id, userId);\n          } catch (error) {\n            console.error(\"Error:\", error);\n          }\n    };\n    const handleEditPost = async ()=>{\n        navigate(`/edit-post?post_id=${post_id}`)\n    }\n\n    const handleDeletePost = async () => {\n        setModalContent({\n            title: \"게시글 삭제\",\n            message: \"게시글을 삭제하시겠습니까? 복구할 수 없습니다.\",\n            onConfirm: async () => {\n              try {\n                await deletePost(post_id);\n                navigate(\"/board\");\n              } catch (error) {\n                console.error(\"Error:\", error);\n              }\n            },\n          });\n          setIsModalOpen(true);\n    };\n    \n\n    \n\n\n\n    return (\n        <>\n        <Header title=\"아무말 대잔치\" profileImage={currentUser ? getImageUrl(currentUser.userInfo.profile_image) : null} onBack={()=> navigate(\"/board\")} />\n        <div className=\"post-container\">\n        {post && (\n          <PostHeader\n            post={post}\n            likeCount={likeCount}\n            handleLike={handleLike}\n            userId={userId}\n            handleDeletePost={handleDeletePost}\n            handleEditPost ={handleEditPost}\n            commentCount= {commentCount}\n          />\n        )}\n         <CommentsSection\n          comments={comments}\n          postId={post_id}\n          setComments={setComments}\n          setCommentCount={setCommentCount}\n          user={currentUser}\n        />\n        </div>\n        {isModalOpen && (\n        <ConfirmationModal\n          show={isModalOpen}\n          title={modalContent.title}\n          message={modalContent.message}\n          onConfirm={modalContent.onConfirm}\n          onCancel={() => setIsModalOpen(false)}\n        />\n      )}\n        </>\n    )\n    \n\n}\n\nexport default DetailPost;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}